### Бизнес реоброзование доменов
#### Core to generic
Домен может перестать быть core в том случае, если на рынок вышел игрок со схожими конкурентными способностями и предоставляет услугу как сервис.

То есть, если у вас была собственная имплементация функционала, который выделял вас среди конкурентов (например, доставка товара), а на рынке появился сервис который можно подключить себе, то ваш поддомен доставки стал generic.

#### Generic to core
Использовали популярное решение на рынке, но решили написать свое, которое утерло нос представленным на рынке - поддомен начал входить в core.

#### Supporting to generic
Та же история, что и с [[#Core to generic]], только core = support.

#### Supporting to core
Когда сервис начинает приносить прибыль и его логика становится сложной, то домен начинает показывать себя с другой стороны и возможно стоит его включить в core.

#### Core to supporting
Запутанную и сложную логику могут кастрировать, превратив в сервис обслуживающий CRUD-ы, оставив на поддержку основную core-часть. 

#### Generic to supporting
Использование дорогих сложных интеграций можно заменить простым доменом.

![[преобразование доменов.png]]

### Технические причины
#### Transaction stript to active record
Если даные внутри поддомена начали приобретать сложную структуру, то имеет смысл перейти на модель active record.

#### Active record to domain model
Слишком много логики и инвариантов, которые сложно соблюдать. 

Начать стоит с выделения VO и переноса логики к этим классам/структурам. Изменения состояни перенсти в класс-методы сущностей и VO. Определить агрегаты и вынести агрегат рут. Также вызов всех методов перенести в рут-агрегат.

#### Domain model to event-sourced domain
Появилась нужда хранить историю изменений.

Начинаем записывать ивенты, а сам агрегат храним как слепок, снепшот.

первый вариант - составить историю создания агрегата самому. Опираясь на бизнес-логику и используя существующие ивенты в системе, создать для каждой записи в базе агрегатов историю событий.

второй - создать один ивент (инит/мигрейт) и принять пропасть в данных. Минус - этот ивент навсегда в базе (или плюс).
