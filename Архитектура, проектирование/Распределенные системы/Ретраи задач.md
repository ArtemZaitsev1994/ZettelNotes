Хранить в памяти программы плохо, потому что:
 - если однопоточное приложение, то заблочит весь поток
 - засорять память

Сохранять задачи где-то в отдельной очереди, бд и читать их отдельным консумером:
 - придется писать дополнительный код
 - скорее всего много кода, скриптов и настроек, чтобы автоматизировать

Стандартное решение:
У RabbitMQ есть параметр при создании очереди **x-message-ttl**, который позволяет задать время жизни сообщению в очереди. Суть мезанизма в следующем. Если при обработке сообщения консьюмером выпала ошибка, то мы помещаем сообщения в dead_letter_exchange, в которой указан x-message-ttl - своеобразный sleep до ретрая. После того, как сообщение "умрет", оно попадет в очередь для ретрая и будет обработано заново.
Схема представлена ниже
![[ретраи очередей.png]]

Для кафки нет таких возможностей, поэтому там предлагается бросать тред с задачей внутри консьюмера в слип. Имеется ввиду, что у кафки меньше автоматизации, но можно организовать все тоже самое руками.

[статья](https://habr.com/ru/company/domclick/blog/500978/)

