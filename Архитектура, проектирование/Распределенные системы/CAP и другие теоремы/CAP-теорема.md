**CAP-теорема** описывает возможность поддержания только 2ух свойств распределенных систем из 3ех: согласованность (Consistency), доступность (Availability) и устойчивость к разделению (Partition tolerance).

* Согласованность - во всех узлах данные в один момент времени не противоречат друг другу.
* Доступность - в любой момент времени отвечает хотя бы один из узлов системы, что не гарантирует согласованность.
* Устойчивость к разделению - разделение системы на несколько частей (в разные физичесик сети) не приводит к некоректным ответам системы.

Соответственно системы бывают трех видов.
-   **CA (Availability + Consistency – Parition tolerance)** когда данные во всех узлах кластера согласованы и доступны, но не устойчивы к разделению. Это означает, что реплики одной и той же информации, распределенные по разным серверам, не противоречат друг другу и любой запрос к распределённой системе завершается корректным откликом. Такие системы возможны при поддержке ACID-требований к транзакциям (Атомарность, Согласованность, Изоляция, Долговечность) и абсолютной надежности сети. На практике таких решений на основе кластерных систем управления базами данных почти не существует. Классическим примером CA-системы называют распределённую службу каталогов LDAP, а также реляционные базы данных (PostgreSQL, MySQL, MariaDB, MS SQL Server).
-   **CP-система (Consistency + Partition tolerance – Availability)** в каждый момент обеспечивает целостность данных и способна работать в условиях сетевой недоступности отдельных узлов в ущерб доступности, не выдавая отклик на запрос. Устойчивость к разделению требует дублирования изменений во всех узлах системы, что реализуется с помощью распределённых пессимистических блокировок для сохранения целостности. По сути, CP – это система с несколькими синхронно обновляемыми мастер-базами. Она всегда корректна, отрабатывая транзакцию, только в том случае, если изменения удалось распространить по всем серверам. Она продолжает корректно читать данные даже при отказе одного из узлов кластера. Но в этом случае запись будет обрываться или сильно задерживаться, пока система не убедится в своей целостности и согласованности (консистентности). Из NoSQL-СУБД к CP-системам принято относить Apache [HBase](https://www.bigdataschool.ru/wiki/hbase), MongoDB, Redis, MemcasheDB, Berkley DB, HyperTable и Google Big Table.
-   **AP-система (Availability + Partition tolerance – Consistency)** не гарантирует целостность данных, обеспечивая их доступность и устойчивость к разделению, например, как в распределённых веб-кэшах и DNS. Считается, что большинство NoSQL-СУБД относятся к этому классу систем, обеспечивая лишь некоторой уровень согласованности данных в конечном счете (eventually consistent). Таким образом, AP-система может быть представлена кластером из нескольких узлов, каждый из которых может принимать данные, но не обязуется в тот же момент распространять их на другие сервера. Такая система отлично справляется с отказами нескольких узлов, но, когда они снова начинают работать, возможна выдача пользователям старых данных. К AP-системам относят CoucheDB, [Cassandra](https://www.bigdataschool.ru/wiki/cassandra), Riak, Amazon DynamoDB

### Критика всего этого добра.
- В математической модели CAP-теоремы под согласованностью подразумевается не ACID-транзакция как в базе данных, а свойство линеаризуемости - когда результат выполнения операций параллельно будет равен их последовательному выполнению (запрашиваем мы данные у всех нашим сервисом последовательно или батчем). Для любого другого потока выполнения линеаризованная операция точечна, то есть либо не начата, либо завершена. Очень похоже на транзакции, но без блокировки.
- Про доступность есть непонятки с метриками. Что делать с задержками? Удовлетворимое время запроса?
- Устойчивость к разделению на практике имеет дело с несовершенством сетей, по факту мы практически всегда находимся в состоянии разделения, когда датацентры находятся не в одной локальной сети.

Альтернативы: [[BASE]], [[PACELC]]


Источник - https://www.bigdataschool.ru/wiki/cap
https://www.bigdataschool.ru/blog/cap-alternatives-for-nosql-and-big-data.html